 <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>The Master Key ‚Äî Mente Abundante</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />

  <!-- Redirecci√≥n desde el dominio ra√≠z hacia la puerta, pero NO cuando viene ref -->
  <script>
    (function () {
      var path = window.location.pathname;
      var params = new URLSearchParams(window.location.search);
      var hasRef = params.has("ref");

      // Si entran solamente al dominio ("/") y no traen ref -> ir a la puerta
      if (path === "/" && !hasRef) {
        window.location.replace("start.html");
      }
    })();
  </script>

  <!-- Estilos espec√≠ficos para landing minimalista -->
  <style>
    body.ma-landing-simple {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "DM Sans", sans-serif;
      background-color: #f6f0e8;
      color: #3a2f25;
      display: flex;
      flex-direction: column;
    }

    .ma-landing-shell {
      max-width: 720px;
      width: 100%;
      margin: 0 auto;
      padding: 2.2rem 1.4rem 2.8rem;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* HEADER MUY SIMPLE */
    .ma-landing-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2.2rem;
    }

    .ma-logo-block {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .ma-logo-tag {
      font-size: 0.9rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: #9b8570;
    }

    .ma-logo-title {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: 0.9rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #3a2f25;
    }

    .ma-login-link {
      font-size: 0.85rem;
      color: #7a6650;
      text-decoration: none;
      border-radius: 999px;
      border: 1px solid rgba(123, 102, 80, 0.25);
      padding: 0.35rem 0.9rem;
      background-color: #fdf8f1;
    }
    .ma-login-link:hover {
      background-color: #f5e4cf;
    }

    /* CONTENIDO CENTRAL */
    .ma-hero-center {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .ma-main-title-eyebrow {
      font-size: 0.75rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: #9b8570;
      margin-bottom: 1.2rem;
    }

    .ma-main-title {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: 2.3rem;
      line-height: 1.2;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #3a2f25;
      margin-bottom: 0.8rem;
    }

    .ma-main-subtitle {
      font-size: 0.98rem;
      color: #7a6650;
      max-width: 32rem;
      margin: 0 auto 1.9rem auto;
    }

    /* VIDEO */
    .ma-video-shell {
      width: 100%;
      max-width: 640px;
      border-radius: 22px;
      background-color: #111111;
      border: 1px solid rgba(0, 0, 0, 0.1);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.12);
      margin: 1.6rem auto 1.8rem auto; /* un poco m√°s de aire arriba */
      overflow: hidden;
    }

    .ma-video-inner {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 */
      background-color: #000;
    }

    .ma-video-placeholder {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f5e4cf;
      font-size: 0.9rem;
      padding: 1rem;
      text-align: center;
    }

    /* BOT√ìN DORADO */
    .ma-cta-wrapper {
      margin-bottom: 2.2rem;
    }

    .ma-cta-button {
      border: none;
      border-radius: 999px;
      padding: 1rem 2.8rem;
      font-size: 1rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #f2c47b, #e3a95a);
      color: #2c241b;
      cursor: pointer;
      box-shadow: 0 18px 50px rgba(226, 167, 90, 0.5);
    }
    .ma-cta-button:hover {
      filter: brightness(1.03);
    }

    /* MENSAJE FINAL */
    .ma-bottom-message {
      margin-top: 2.8rem;
      text-align: center;
      font-size: 1rem;
      color: #97826b;
      padding-top: 1.8rem;
      opacity: 0.9;
    }

    .ma-bottom-message::before {
      content: "";
      display: block;
      width: 60%;
      height: 1px;
      margin: 2.2rem auto 1.6rem auto;
      background: rgba(0, 0, 0, 0.08);
    }
  .tm-index-btn-secondary {
  margin-top: 0.9rem;
  padding: 0.55rem 1.6rem;
  border-radius: 999px;
  border: 1px solid rgba(243, 207, 138, 0.7);
  background: transparent;
  color: #97826b; 
  font-size: 0.8rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  cursor: pointer;
  opacity: 0.9;
}

.tm-index-btn-secondary:hover {
  opacity: 1;
  background: rgba(243, 207, 138, 0.08);
}
   
    @media (max-width: 600px) {
      .ma-landing-shell {
        padding: 1.6rem 1.1rem 2.2rem;
      }
      .ma-main-title {
        font-size: 1.9rem;
        letter-spacing: 0.14em;
      }
      .ma-main-subtitle {
        font-size: 0.92rem;
      }
  
 
    }
  </style>
</head>

<body class="ma-landing-simple">
  <div class="ma-landing-shell">
    <!-- HEADER MUY SIMPLE -->
    <header class="ma-landing-header">
      <div class="ma-logo-block">
        <span class="ma-logo-tag">Programa privado</span>
        
      </div>
      <a href="login.html" class="ma-login-link">Entrar</a>
    </header>

    <!-- CONTENIDO CENTRAL -->
    <main class="ma-hero-center">
      

      <h1 class="ma-main-title">The Master Key</h1>

      <p class="ma-main-subtitle">
        El programa que abre la puerta para la vida que tanto has esperado.
        No es casualidad que est√©s aqu√≠. .
      </p>
<span class="ma-logo-title">Mira este video hasta el final</span>
      <!-- VIDEO PRINCIPAL -->
      <section class="ma-video-shell">
        <div class="ma-video-inner" id="maIntroVideo">
          <!-- TODO: Reemplaza este bloque por tu iframe/video real -->
          <div class="ma-video-placeholder">
            Aqu√≠ va tu video principal de introducci√≥n.
            <br />
            (Reemplaza este bloque por tu iframe de YouTube o reproductor real).
          </div>
        </div>
      </section>
<div class="ma-main-title-eyebrow">Puertas ¬∑ Decisi√≥n ¬∑ Abundancia</div>
      <!-- BOT√ìN DORADO -->
      <div class="ma-cta-wrapper">
        <button id="btnSiQuiero" type="button" class="ma-cta-button">
          S√≠ quiero
        </button> 
      </div>
       <button
  class="tm-index-btn-secondary"
  type="button"
  onclick="window.location.href='index-en.html'"
>
  English
</button>

      </div>
    </main>

    <!-- MENSAJE FINAL -->
    <div class="ma-bottom-message">
      Prep√°rate. Tu nueva vida est√° por comenzar.
    </div>
  </div>

  <!-- L√ìGICA PARA REF Y BOT√ìN "S√ç QUIERO" -->
  <script>
(function () {
  const API = "https://mente-abundante-api-1.onrender.com"; // <-- si tu API base es otra, d√≠melo
  const params = new URLSearchParams(window.location.search);
  const ref = params.get("ref") || "";

  const btnSiQuiero = document.getElementById("btnSiQuiero");
  const overlay = document.getElementById("tmkGateOverlay");
  const cdEl = document.getElementById("tmkGateCountdown");

  // 1) Guardar ref si viene por link / QR
  try {
    if (ref) localStorage.setItem("ma_ref_code", ref);
  } catch (e) {}

  function hasValidGatePass() {
    try {
      const until = parseInt(localStorage.getItem("ma_gate_pass_until") || "0", 10);
      return Date.now() < until;
    } catch {
      return false;
    }
  }

  function grantGatePass() {
    try {
      localStorage.setItem("ma_gate_pass_until", String(Date.now() + 2 * 60 * 60 * 1000)); // 2 horas
    } catch (e) {}
  }

  function formatTime(sec) {
    sec = Math.max(0, sec | 0);
    const m = String(Math.floor(sec / 60)).padStart(2, "0");
    const s = String(sec % 60).padStart(2, "0");
    return `${m}:${s}`;
  }

  function showOverlay(retrySeconds) {
    if (!overlay) return;
    overlay.style.display = "flex";

    let remaining = retrySeconds || 3600;
    if (cdEl) cdEl.textContent = formatTime(remaining);

    // bloquear bot√≥n
    if (btnSiQuiero) {
      btnSiQuiero.disabled = true;
      btnSiQuiero.style.opacity = "0.6";
      btnSiQuiero.style.cursor = "not-allowed";
    }

    setInterval(() => {
      remaining--;
      if (remaining >= 0 && cdEl) cdEl.textContent = formatTime(remaining);
    }, 1000);
  }

  async function getGate() {
    try {
      const r = await fetch(API + "/gate/status");
      const j = await r.json();
      return j?.gate || { open: true };
    } catch (e) {
      // staging-friendly: si falla, no bloqueamos
      return { open: true };
    }
  }

  function wireContinue() {
    if (!btnSiQuiero) return;

    btnSiQuiero.addEventListener("click", function () {
      let target = "membresia.html";
      if (ref) {
        const url = new URL(target, window.location.origin);
        url.searchParams.set("ref", ref);
        target = url.pathname + url.search;
      }
      window.location.href = target;
    });
  }

  async function init() {
    const gate = await getGate();

    // Si est√° cerrado y NO tiene pase -> bloquear (nuevos)
    if (!gate.open && !hasValidGatePass()) {
      showOverlay(gate.retrySeconds);
      return;
    }

    // Si est√° abierto -> dar pase (para que si se cierra despu√©s, puedan terminar)
    if (gate.open) {
      grantGatePass();
    }

    // continuar normal
    wireContinue();
  }

  init();
})();

</script>
   
<!-- OVERLAY GATE (solo aparece cuando est√° cerrado) -->
<div id="tmkGateOverlay" style="
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  padding:24px;
  background:rgba(0,0,0,0.55);
  z-index:9999;
">
  <div style="
    max-width:420px;
    width:100%;
    background:#fdf8f1;
    border-radius:22px;
    padding:22px 18px;
    text-align:center;
    border:1px solid rgba(0,0,0,0.08);
    box-shadow:0 20px 60px rgba(0,0,0,0.25);
    color:#3a2f25;
    font-family:system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  ">
    <h2 style="margin:0 0 10px 0;">Acceso temporalmente en pausa</h2>
    <p style="margin:0 0 14px 0; color:#7a6650;">
      Estamos cuidando la experiencia de los miembros.<br>
      Intenta nuevamente en:
    </p>
    <div id="tmkGateCountdown" style="font-size:34px; margin:10px 0 12px 0;">
      60:00
    </div>
    <p style="margin:0; color:#97826b; opacity:.9;">
      Gracias por tu paciencia üôè
    </p>
  </div>
</div>


</body>
</html>
