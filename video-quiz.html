 <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Mente Abundante â€” Video + Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body class="ma-body">
  <div class="main-shell">
    <div class="card single">
      <!-- LOGO + TÃTULO -->
      <div class="logo-row" style="margin-bottom: 1rem;">
        <div class="logo-drop"></div>
        <div>
          <div class="logo-text-main">MENTE ABUNDANTE</div>
          <div class="logo-text-sub">Video principal + integraciÃ³n</div>
        </div>
      </div>

      <h2>Video principal: Yo Decido Ser Abundante</h2>

      <p class="small-note" style="margin-bottom: 1rem;">
        Te recomendamos verlo con calma, en un lugar tranquilo.  
        Este video estÃ¡ disponible solo <strong>un nÃºmero limitado de veces</strong>.
      </p>

      <!-- BLOQUE MENSAJE LIMITE -->
      <p id="limitMessage" class="small-note" style="color:#b33434; display:none; margin-bottom:1rem;"></p>

      <!-- SECCIÃ“N VIDEO -->
      <section id="videoSection" style="margin-bottom: 1.5rem;">
        <div class="landing-video-frame">
          <!-- ğŸ‘‡ Cuando tengas el video en Vimeo, reemplaza el src de este iframe -->
          <iframe
            id="maMainVideo"
            src="https://player.vimeo.com/video/XXXXXXXX" 
            frameborder="0"
            allow="autoplay; fullscreen; picture-in-picture"
            allowfullscreen
          ></iframe>
        </div>
        <p class="small-note">
          El contenido de este video es para tu uso personal como miembro de Mente Abundante.
          No estÃ¡ permitido descargarlo, grabarlo ni compartirlo pÃºblicamente.
        </p>
      </section>

      <!-- SECCIÃ“N QUIZ -->
      <section id="quizSection">
        <h3>PequeÃ±o quiz de integraciÃ³n</h3>
        <p class="small-note" style="margin-bottom:0.8rem;">
          No es un examen, es una forma de ayudarte a integrar lo que escuchaste.
          Responde con honestidad.
        </p>

        <form id="quizForm" class="form">
          <!-- Pregunta 1 -->
          <div>
            <div class="label">
              1. Â¿CuÃ¡l es la decisiÃ³n principal que tomas al ver este video?
            </div>
            <input
              type="text"
              name="q1"
              class="input"
              placeholder="EscrÃ­belo con tus propias palabras"
              required
            />
          </div>

          <!-- Pregunta 2 -->
          <div>
            <div class="label">
              2. Â¿QuÃ© es para ti â€œser abundanteâ€ despuÃ©s de escuchar este mensaje?
            </div>
            <input
              type="text"
              name="q2"
              class="input"
              placeholder="Describe en una frase"
              required
            />
          </div>

          <!-- Pregunta 3 -->
          <div>
            <div class="label">
              3. Menciona una acciÃ³n concreta que vas a tomar en los prÃ³ximos 7 dÃ­as.
            </div>
            <input
              type="text"
              name="q3"
              class="input"
              placeholder="Ej. Hablar conâ€¦, iniciarâ€¦, soltarâ€¦"
              required
            />
          </div>

          <!-- Puedes duplicar bloques y llegar hasta 10 preguntas si quieres -->

          <button type="submit" class="btn btn-primary" style="margin-top: 0.8rem;">
            Enviar respuestas y continuar
          </button>

          <p id="quizMessage" class="small-note" style="margin-top:0.6rem;"></p>
        </form>
      </section>

      <div class="button-row" style="margin-top: 1.4rem;">
        <a href="index.html" class="btn btn-secondary">Volver al inicio</a>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const MAX_VIEWS = 3; // ğŸ‘ˆ Cambia a 2 si quieres solo 2 vistas
      const VIEWS_KEY = "ma_video2_views";

      const videoSection = document.getElementById("videoSection");
      const quizSection = document.getElementById("quizSection");
      const limitMessage = document.getElementById("limitMessage");
      const quizForm = document.getElementById("quizForm");
      const quizMessage = document.getElementById("quizMessage");

      // Leer vistas previas desde localStorage
      let currentViews = parseInt(localStorage.getItem(VIEWS_KEY) || "0", 10);

      if (currentViews >= MAX_VIEWS) {
        // Ya se pasÃ³ del lÃ­mite
        videoSection.style.display = "none";
        quizSection.style.display = "none";
        limitMessage.style.display = "block";
        limitMessage.textContent =
          "Has alcanzado el nÃºmero mÃ¡ximo de visualizaciones permitidas para este video.";
      } else {
        // Incrementar contador de vistas al cargar la pÃ¡gina
        currentViews += 1;
        localStorage.setItem(VIEWS_KEY, String(currentViews));

        if (MAX_VIEWS - currentViews >= 0) {
          limitMessage.style.display = "block";
          limitMessage.style.color = "#444";
          limitMessage.textContent =
            "Esta es una de tus " +
            MAX_VIEWS +
            " visualizaciones permitidas de este video. Te quedan " +
            (MAX_VIEWS - currentViews) +
            " intento(s).";
        }
      }

      // Manejo del quiz
      quizForm.addEventListener("submit", (e) => {
        e.preventDefault();
        quizMessage.textContent = "";

        const formData = new FormData(quizForm);
        const q1 = (formData.get("q1") || "").toString().trim();
        const q2 = (formData.get("q2") || "").toString().trim();
        const q3 = (formData.get("q3") || "").toString().trim();

        if (!q1 || !q2 || !q3) {
          quizMessage.textContent = "Por favor responde todas las preguntas.";
          quizMessage.style.color = "#b33434";
          return;
        }

        // MÃ¡s adelante aquÃ­ podemos enviar las respuestas al backend
        // fetch("/api/quiz/submit", { ... })

        quizMessage.textContent =
          "Gracias por tus respuestas. Ahora estÃ¡s listo para crear tu cuenta.";
        quizMessage.style.color = "#2f7b3b";

        // PequeÃ±o delay y luego redirigir a la pÃ¡gina de crear cuenta
        setTimeout(() => {
          // ğŸ‘‡ Cambia 'signup.html' por el nombre real de tu pÃ¡gina de registro
          window.location.href = "signup.html";
        }, 1200);
      });
    });
  </script>
</body>
</html>
