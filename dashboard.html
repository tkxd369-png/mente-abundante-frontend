<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Mente Abundante - Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Fuentes -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=DM+Sans:wght@400;500;600&family=Dancing+Script:wght@500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />

    <!-- Estilos simples para el selector de idioma -->
    <style>
      .ma-dashboard-brand-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
      }

      .ma-lang-switch {
        display: flex;
        gap: 0.4rem;
      }

      .ma-lang-btn {
        border: 1px solid rgba(0, 0, 0, 0.12);
        background: #ffffff;
        padding: 0.18rem 0.75rem;
        border-radius: 999px;
        font-size: 0.7rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        cursor: pointer;
      }

      .ma-lang-btn.active {
        border-color: #d4af37;
        background: #d4af37;
        color: #ffffff;
      }
    </style>
  </head>

  <body class="ma-body ma-dashboard">
    <div class="ma-page-wrapper ma-dashboard-wrapper">
      <!-- HEADER -->
      <header id="dashboardHeader" class="ma-dashboard-header">
        <div class="ma-dashboard-brand-row">
          <h1 class="ma-logo">MENTE ABUNDANTE</h1>

          <!-- Selector de idioma ES / EN -->
          <div class="ma-lang-switch">
            <button
              type="button"
              class="ma-lang-btn"
              data-lang="es"
              id="langEsBtn"
            >
              ES
            </button>
            <button
              type="button"
              class="ma-lang-btn"
              data-lang="en"
              id="langEnBtn"
            >
              EN
            </button>
          </div>
        </div>

        <div class="ma-dashboard-user-row">
          <div class="ma-dashboard-user-name">
            <span id="dashName" class="ma-user-name">Nombre</span>
          </div>

          <div class="ma-dashboard-user-meta">
            <!-- Badge referidos + estimado (JS escribe el texto) -->
            <button id="dashRefBadge" class="ma-ref-badge" type="button">
              <span id="dashReferralsText">0 REFERIDOS</span>
              <span id="dashEstimateText">$0 USD ESTIMADO</span>
            </button>
            <button class="ma-icon-button" id="dashMenuBtn" type="button">
              ‚ãÆ
            </button>
          </div>
        </div>
      </header>

      <!-- CONTENIDO SCROLL -->
      <main class="ma-dashboard-main">
        <!-- Bloque 1: Frase AI -->
        <section class="ma-card ma-block ma-block-phrase">
          <h2 class="ma-section-label" data-i18n="phrase.title">
            TU FRASE DE HOY
          </h2>
          <p id="aiPhraseText" class="ma-phrase-text">
            ‚ÄúTu decisi√≥n de hoy abre puertas que a√∫n no imaginas.‚Äù
          </p>
        </section>

        <!-- Bloque 2: Pinterest -->
        <section class="ma-card">
          <h2 class="ma-section-label" data-i18n="pinterest.title">
            INSPIRACI√ìN VISUAL
          </h2>
          <div id="pinterestEmbed" class="ma-embed-box">
            <a
              data-pin-do="embedBoard"
              data-pin-board-width="420"
              data-pin-scale-height="320"
              data-pin-scale-width="120"
              href="https://www.pinterest.com/agconst/mente-abundante/"
            >
            </a>
          </div>
        </section>

        <!-- Bloque 3: TikTok -->
        <section class="ma-card">
          <h2 class="ma-section-label" data-i18n="tiktok.title">
            VIDEOS TIKTOK / REELS
          </h2>
          <div class="ma-embed-box ma-embed-elfsight">
            <div
              class="elfsight-app-c7aa3b7a-2625-4e48-932a-c5a323679564"
              data-elfsight-app-lazy
            ></div>
          </div>
        </section>

        <!-- === TUS ACCESOS R√ÅPIDOS === -->
        <section class="ma-card ma-quick-section">
          <div class="ma-section-label" data-i18n="quick.title">
            TUS ACCESOS R√ÅPIDOS
          </div>

          <div class="ma-quick-row">
            <!-- E-BOOK -->
            <button
              type="button"
              class="ma-quick-card ma-quick-card-ebook"
            >
              <span class="ma-quick-icon">üìò</span>
              <span class="ma-quick-label">E-BOOK</span>
              <span class="ma-quick-cta" data-i18n="quick.ebookCta">
                Leer ahora
              </span>
            </button>

            <!-- HERRAMIENTAS -->
            <a
              href="herramientas.html"
              class="ma-quick-card ma-quick-card-tools ma-quick-card-link"
            >
              <span class="ma-quick-icon ma-quick-icon-money">$</span>
              <span
                class="ma-quick-label"
                data-i18n="quick.toolsTitle"
              >
                HERRAMIENTAS
              </span>
              <span class="ma-quick-cta" data-i18n="quick.toolsCta">
                Gu√≠as para compartir
              </span>
            </a>

            <!-- TU QR -->
            <button
              type="button"
              class="ma-quick-card ma-quick-card-qr"
            >
              <canvas id="dashQrSmall"></canvas>
              <span
                class="ma-quick-label"
                data-i18n="quick.qrTitle"
              >
                TU QR
              </span>
              <span class="ma-quick-cta" data-i18n="quick.qrCta">
                Compartir
              </span>
            </button>
          </div>

          <p class="ma-quick-note" data-i18n="quick.note">
            Comparte tu QR para que tus invitados lleguen directo a tu
            p√°gina de inicio.
          </p>
        </section>

        <!-- Bloque 5: Newsletter / anuncios -->
        <section class="ma-card ma-block ma-block-news">
          <h2 class="ma-section-label" data-i18n="news.title">
            NEWSLETTER & ANUNCIOS
          </h2>
          <p class="ma-news-text" data-i18n="news.text">
            Pr√≥ximos lanzamientos, noticias de la comunidad y recordatorios
            importantes aparecer√°n aqu√≠.
          </p>
        </section>
      </main>

      <!-- FOOTER -->
      <footer class="ma-dashboard-footer">
        <div class="ma-footer-refid" id="footerRefId">
          C√ìDIGO: ‚Äî‚Äî‚Äî
        </div>

        <div class="ma-footer-btn-row">
          <button
            type="button"
            class="ma-footer-btn"
            id="footerNewBooksBtn"
            data-i18n="footer.newBooks"
          >
            NUEVOS LIBROS
          </button>
          <button
            type="button"
            class="ma-footer-btn"
            id="footerNewsBtn"
            data-i18n="footer.news"
          >
            NOVEDADES
          </button>
          <button
            type="button"
            class="ma-footer-btn"
            id="footerExtraBtn"
            data-i18n="footer.extra"
          >
            ANUNCIOS
          </button>
        </div>

        <button
          type="button"
          class="ma-footer-logout"
          id="logoutBtn"
          data-i18n="footer.logout"
        >
          CERRAR SESI√ìN
        </button>
      </footer>
    </div>

    <!-- Toast -->
    <div id="maToast" class="ma-toast">Copiado</div>

    <!-- Popup QR grande (√∫nico) -->
    <div class="ma-qr-modal" id="qrModal">
      <div class="ma-qr-modal-backdrop" id="qrModalBackdrop"></div>
      <div class="ma-qr-modal-content">
        <button class="ma-qr-modal-close" id="qrModalClose" type="button">
          &times;
        </button>
        <h2
          class="ma-qr-modal-title"
          data-i18n="qr.title"
        >
          Tu c√≥digo de invitaci√≥n
        </h2>
        <p class="ma-qr-modal-ref" id="qrModalRefText">C√ìDIGO: ‚Äî‚Äî‚Äî</p>
        <canvas
          id="qrModalCanvas"
          class="ma-qr-modal-canvas"
        ></canvas>
        <p class="ma-qr-modal-help" data-i18n="qr.help">
          Pide que escaneen este QR o comparte tu enlace personal.
        </p>
      </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <script src="app.js"></script>
    <script
      async
      defer
      src="https://assets.pinterest.com/js/pinit.js"
    ></script>
    <script src="https://elfsightcdn.com/platform.js" async></script>

    <!-- Sistema de idioma ES / EN para el dashboard -->
    <script>
      (function () {
        const LANG_KEY = "ma_lang";

        const DASH_TRANSLATIONS = {
          es: {
            "phrase.title": "TU FRASE DE HOY",
            "pinterest.title": "INSPIRACI√ìN VISUAL",
            "tiktok.title": "VIDEOS TIKTOK / REELS",
            "quick.title": "TUS ACCESOS R√ÅPIDOS",
            "quick.ebookCta": "Leer ahora",
            "quick.toolsTitle": "HERRAMIENTAS",
            "quick.toolsCta": "Gu√≠as para compartir",
            "quick.qrTitle": "TU QR",
            "quick.qrCta": "Compartir",
            "quick.note":
              "Comparte tu QR para que tus invitados lleguen directo a tu p√°gina de inicio.",
            "news.title": "NEWSLETTER & ANUNCIOS",
            "news.text":
              "Pr√≥ximos lanzamientos, noticias de la comunidad y recordatorios importantes aparecer√°n aqu√≠.",
            "footer.newBooks": "NUEVOS LIBROS",
            "footer.news": "NOVEDADES",
            "footer.extra": "ANUNCIOS",
            "footer.logout": "CERRAR SESI√ìN",
            "qr.title": "Tu c√≥digo de invitaci√≥n",
            "qr.help":
              "Pide que escaneen este QR o comparte tu enlace personal.",
          },
          en: {
            "phrase.title": "YOUR PHRASE FOR TODAY",
            "pinterest.title": "VISUAL INSPIRATION",
            "tiktok.title": "TIKTOK / REELS VIDEOS",
            "quick.title": "YOUR QUICK ACCESS",
            "quick.ebookCta": "Read now",
            "quick.toolsTitle": "TOOLS",
            "quick.toolsCta": "Sharing guides",
            "quick.qrTitle": "YOUR QR",
            "quick.qrCta": "Share",
            "quick.note":
              "Share your QR so your guests go directly to your start page.",
            "news.title": "NEWSLETTER & ANNOUNCEMENTS",
            "news.text":
              "Upcoming launches, community news and important reminders will appear here.",
            "footer.newBooks": "NEW BOOKS",
            "footer.news": "UPDATES",
            "footer.extra": "ANNOUNCEMENTS",
            "footer.logout": "LOG OUT",
            "qr.title": "Your invitation code",
            "qr.help":
              "Ask them to scan this QR or share your personal link.",
          },
        };

        function getCurrentLang() {
          const stored = localStorage.getItem(LANG_KEY);
          if (stored === "en" || stored === "es") return stored;
          return "es"; // por defecto espa√±ol
        }

        function setCurrentLang(lang) {
          localStorage.setItem(LANG_KEY, lang);
        }

        function applyDashboardLanguage() {
          const lang = getCurrentLang();
          const dict = DASH_TRANSLATIONS[lang];

          // Textos con data-i18n
          document.querySelectorAll("[data-i18n]").forEach((el) => {
            const key = el.getAttribute("data-i18n");
            if (dict[key]) {
              el.textContent = dict[key];
            }
          });

          // Botones de idioma activos
          document
            .querySelectorAll(".ma-lang-btn")
            .forEach((btn) => {
              const btnLang = btn.getAttribute("data-lang");
              btn.classList.toggle("active", btnLang === lang);
            });
        }

        document.addEventListener("DOMContentLoaded", function () {
          if (!document.body.classList.contains("ma-dashboard")) return;

          applyDashboardLanguage();

          document
            .querySelectorAll(".ma-lang-btn")
            .forEach((btn) => {
              btn.addEventListener("click", function () {
                const lang = this.getAttribute("data-lang");
                setCurrentLang(lang);
                applyDashboardLanguage();
              });
            });
        });
      })();
    </script>

    <!-- Header compact al hacer scroll -->
    <script>
      (function () {
        const header = document.getElementById("dashboardHeader");
        if (!header) return;
        function onScroll() {
          const y = window.scrollY || document.documentElement.scrollTop;
          if (y > 24) {
            header.classList.add("ma-header-compact");
          } else {
            header.classList.remove("ma-header-compact");
          }
        }
        window.addEventListener("scroll", onScroll, { passive: true });
        onScroll();
      })();
    </script>

    <!-- QR peque√±o + modal QR grande -->
    <script>
      (function () {
        // Tarjeta QR peque√±a
        const qrTile = document.querySelector(".ma-quick-card-qr");
        const qrCanvasSmall = document.getElementById("dashQrSmall");

        // Modal QR grande
        const modal = document.getElementById("qrModal");
        const modalBackdrop = document.getElementById("qrModalBackdrop");
        const modalClose = document.getElementById("qrModalClose");
        const modalCanvas = document.getElementById("qrModalCanvas");
        const modalRefText = document.getElementById("qrModalRefText");

        if (!qrTile || !qrCanvasSmall || !modal || !modalCanvas) {
          return;
        }

        // Obtener usuario y refid desde localStorage
        let user = null;
        try {
          user = JSON.parse(localStorage.getItem("ma_user") || "{}");
        } catch (e) {
          user = {};
        }

        const refid = user.refid || user.refId || "‚Äî‚Äî‚Äî";

        // Construir link personal: https://TU-DOMINIO/index.html?ref=REFID
        const baseUrl = window.location.origin + "/index.html";
        const personalLink =
          refid && refid !== "‚Äî‚Äî‚Äî"
            ? baseUrl + "?ref=" + encodeURIComponent(refid)
            : baseUrl;

        // Peque√±o QR en la tarjeta
        try {
          new QRious({
            element: qrCanvasSmall,
            value: personalLink,
            size: 68,
          });
        } catch (e) {
          console.warn("No se pudo generar el QR peque√±o:", e);
        }

        // QR grande en el modal
        try {
          new QRious({
            element: modalCanvas,
            value: personalLink,
            size: 220,
          });
        } catch (e) {
          console.warn("No se pudo generar el QR grande:", e);
        }

        // Texto del c√≥digo en el modal
        if (modalRefText) {
          modalRefText.textContent = "C√ìDIGO: " + (refid || "‚Äî‚Äî‚Äî");
        }

        // Funciones para abrir/cerrar modal
        function openModal() {
          modal.classList.add("is-visible");
        }

        function closeModal() {
          modal.classList.remove("is-visible");
        }

        // Conectar eventos
        qrTile.addEventListener("click", openModal);
        if (modalBackdrop) {
          modalBackdrop.addEventListener("click", closeModal);
        }
        if (modalClose) {
          modalClose.addEventListener("click", closeModal);
        }
      })();
    </script>
  </body>
</html>
 
