 
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>The Master Key - Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=DM+S
ans:wght@400;500;600&family=Dancing+Script:wght@500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="ma-body ma-dashboard">
  <div class="ma-page-wrapper ma-dashboard-wrapper">
    <!-- HEADER -->
    <header id="dashboardHeader" class="ma-dashboard-header">
      <div class="ma-dashboard-brand-row">
        <h1 class="ma-logo">THE MASTER KEY</h1>
      </div>
      <div class="ma-dashboard-user-row">
        <div class="ma-dashboard-user-name">
          <span id="dashName" class="ma-user-name">Nombre</span>
        </div>
        <div class="ma-dashboard-user-meta">
          <!-- Badge referidos + estimado (JS escribe el texto) -->
          <button id="dashRefBadge" class="ma-ref-badge" type="button">
            <span id="dashReferralsText">0 REFS</span>
            <span id="dashEstimateText">$0 USD EST</span>
          </button>
          <button class="ma-icon-button" id="dashMenuBtn" type="button"> </button>
        </div>
      </div>
    </header>
    <!-- CONTENIDO -->
    <main class="ma-dashboard-main">
      <!-- Bloque: Frase -->
      <section class="ma-card ma-block ma-block-phrase">
        <h2 class="ma-section-label" data-i18n="phrase.title">TU FRASE DE HOY</h2>
        <p id="aiPhraseText" class="ma-phrase-text">“Tu decisión de hoy abre puertas que aún no 
imaginas.”</p>
      </section>
      <!-- Pinterest -->
      <section class="ma-card">
        <h2 class="ma-section-label" data-i18n="pinterest.title">INSPIRACIÓN VISUAL</h2>
        <div id="pinterestEmbed" class="ma-embed-box">
          <a
            data-pin-do="embedBoard"
            data-pin-board-width="420"
            data-pin-scale-height="320"
            data-pin-scale-width="120"
            href="https://www.pinterest.com/agconst/mente-abundante/">
          </a>
        </div>
      </section>
      <!-- TikTok / Reels -->
      <section class="ma-card">
        <h2 class="ma-section-label" data-i18n="tiktok.title">VIDEOS TIKTOK / REELS</h2>
        <div class="ma-embed-box ma-embed-elfsight">
          <div class="elfsight-app-c7aa3b7a-2625-4e48-932a-c5a323679564" data-elfsight-app
lazy></div>
        </div>
      </section>
      <!-- === TUS ACCESOS RÁPIDOS === -->
      <section class="ma-card ma-quick-section">
        <div class="ma-section-label" data-i18n="quick.title">TUS ACCESOS RÁPIDOS</div>
        <div class="ma-quick-row">
          <!-- E-BOOK -->
          <button type="button" id="ebookBtn" class="ma-quick-card ma-quick-card-ebook">
            <span class="ma-quick-icon"></span>
            <span class="ma-quick-label">E-BOOK</span>
            <span class="ma-quick-cta" data-i18n="quick.ebookCta">Leer ahora</span>
          </button>
          <!-- HERRAMIENTAS -->
          <a href="herramientas.html" class="ma-quick-card ma-quick-card-tools ma-quick-card
link">
            <span class="ma-quick-icon ma-quick-icon-money">$</span>
            <span class="ma-quick-label" data-i18n="quick.toolsTitle">HERRAMIENTAS</span>
            <span class="ma-quick-cta" data-i18n="quick.toolsCta">Guías para compartir</span>
          </a>
          <!-- TU QR -->
          <button type="button" class="ma-quick-card ma-quick-card-qr">
            <canvas id="dashQrSmall"></canvas>
            <span class="ma-quick-label" data-i18n="quick.qrTitle">TU QR</span>
            <span class="ma-quick-cta" data-i18n="quick.qrCta">Compartir</span>
          </button>
        </div>
        <p class="ma-quick-note" data-i18n="quick.note">
          Comparte tu QR para que tus invitados lleguen directo a tu página de inicio.
        </p>
      </section>
      <!-- === VAULT (BANNERS) === -->
      <section class="ma-card ma-vault-section" id="vaultSection">
        <h2 class="ma-section-label" data-i18n="vault.title">TU VAULT</h2>
        <div class="ma-vault-grid">
          <!-- WEBBOOK (siempre visible) -->
          <a href="/ebook/index.html" id="vaultWebbookBtn" class="ma-vault-banner">
            <div class="ma-vault-top">
              <div class="ma-vault-kicker" data-i18n="vault.webbookKicker">LECTURA</div>
              <div class="ma-vault-title" data-i18n="vault.webbookTitle">WEBBOOK</div>
            </div>
            <div class="ma-vault-sub" data-i18n="vault.webbookSub">Continúa tu lectura</div>
            <div class="ma-vault-cta" data-i18n="vault.open">ABRIR</div>
          </a>
          <!-- TRUTH PATH (solo cuando esté desbloqueado) -->
          <a href="/media/ttps/index.html" id="vaultTtpBtn" class="ma-vault-banner" 
style="display:none">
            <div class="ma-vault-top">
              <div class="ma-vault-kicker" data-i18n="vault.pathKicker">SENDERO</div>
              <div class="ma-vault-title" data-i18n="vault.pathTitle">THE TRUTH PATH</div>
            </div>
            <div class="ma-vault-sub" data-i18n="vault.pathSub">Tu jornada de 40 días</div>
            <div class="ma-vault-cta" data-i18n="vault.open">ABRIR</div>
          </a>
          <!-- HERRAMIENTAS (siempre visible) -->
          <a href="herramientas.html" class="ma-vault-banner">
            <div class="ma-vault-top">
              <div class="ma-vault-kicker" data-i18n="vault.toolsKicker">GUÍAS</div>
              <div class="ma-vault-title" data-i18n="vault.toolsTitle">HERRAMIENTAS</div>
            </div>
            <div class="ma-vault-sub" data-i18n="vault.toolsSub">Recursos para compartir</div>
            <div class="ma-vault-cta" data-i18n="vault.open">ABRIR</div>
          </a>
        </div>
        <p class="ma-vault-note" data-i18n="vault.note">
          Todo aquí se mantiene protegido dentro del dashboard.
        </p>
      </section>
      <!-- Newsletter -->
      <section class="ma-card ma-block ma-block-news">
        <h2 class="ma-section-label" data-i18n="news.title">NEWSLETTER & ANUNCIOS</h2>
        <p class="ma-news-text" data-i18n="news.text">
          Próximos lanzamientos, noticias de la comunidad y recordatorios importantes aparecerán
 aquí.
        </p>
      </section>
    </main>
    <!-- FOOTER -->
    <footer class="ma-dashboard-footer">
      <div class="ma-footer-refid" id="footerRefId">CÓDIGO: ———</div>
      <div class="ma-footer-btn-row">
        <button type="button" class="ma-footer-btn" id="footerNewBooksBtn" 
data-i18n="footer.newBooks">NUEVOS LIBROS</button>
        <button type="button" class="ma-footer-btn" id="footerNewsBtn" 
data-i18n="footer.news">NOVEDADES</button>
        <button type="button" class="ma-footer-btn" id="footerExtraBtn" 
data-i18n="footer.extra">ANUNCIOS</button>
      </div>
      <!-- Botón para cambiar estilo del dashboard -->
      <button type="button" class="ma-footer-style" id="styleToggleBtn">ESTILO: CLÁSICO</button>
      <button type="button" class="ma-footer-logout" id="logoutBtn" 
data-i18n="footer.logout">CERRAR SESIÓN</button>
    </footer>
  </div>
  <!-- Toast -->
  <div id="maToast" class="ma-toast">Copiado</div>
  <!-- Modal QR -->
  <div class="ma-qr-modal" id="qrModal">
    <div class="ma-qr-modal-backdrop" id="qrModalBackdrop"></div>
    <div class="ma-qr-modal-content">
      <button class="ma-qr-modal-close" id="qrModalClose" type="button">&times;</button>
      <h2 class="ma-qr-modal-title" data-i18n="qr.title">Tu código de invitación</h2>
      <p class="ma-qr-modal-ref" id="qrModalRefText">CÓDIGO: ———</p>
      <canvas id="qrModalCanvas" class="ma-qr-modal-canvas"></canvas>
      <p class="ma-qr-modal-help" data-i18n="qr.help">Pide que escaneen este QR o comparte tu 
enlace personal.</p>
    </div>
  </div>
  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <script src="app.js"></script>
  <script async defer src="https://assets.pinterest.com/js/pinit.js"></script>
  <script src="https://elfsightcdn.com/platform.js" async></script>
  <!-- Idioma ES/EN -->
  <script>
  (function () {
    const LANG_KEY = "ma_lang";
    const DASH_TRANSLATIONS = {
      es: {
        "phrase.title": "TU FRASE DE HOY",
        "pinterest.title": "INSPIRACIÓN VISUAL",
        "tiktok.title": "VIDEOS TIKTOK / REELS",
        "quick.title": "TUS ACCESOS RÁPIDOS",
        "quick.ebookCta": "Leer ahora",
        "quick.toolsTitle": "HERRAMIENTAS",
        "quick.toolsCta": "Guías para compartir",
        "quick.qrTitle": "TU QR",
        "quick.qrCta": "Compartir",
        "quick.note": "Comparte tu QR para que tus invitados lleguen directo a tu página de 
inicio.",
        "vault.title": "TU VAULT",
        "vault.webbookKicker": "LECTURA",
        "vault.webbookTitle": "WEBBOOK",
        "vault.webbookSub": "Continúa tu lectura",
        "vault.pathKicker": "SENDERO",
        "vault.pathTitle": "THE TRUTH PATH",
        "vault.pathSub": "Tu jornada de 40 días",
        "vault.toolsKicker": "GUÍAS",
        "vault.toolsTitle": "HERRAMIENTAS",
        "vault.toolsSub": "Recursos para compartir",
        "vault.open": "ABRIR",
        "vault.note": "Todo aquí se mantiene protegido dentro del dashboard.",
        "news.title": "NEWSLETTER & ANUNCIOS",
        "news.text": "Próximos lanzamientos, noticias de la comunidad y recordatorios 
importantes aparecerán aquí.",
        "footer.newBooks": "NUEVOS LIBROS",
        "footer.news": "NOVEDADES",
        "footer.extra": "ANUNCIOS",
        "footer.logout": "CERRAR SESIÓN",
        "qr.title": "Tu código de invitación",
        "qr.help": "Pide que escaneen este QR o comparte tu enlace personal."
      },
      en: {
        "phrase.title": "YOUR PHRASE FOR TODAY",
        "pinterest.title": "VISUAL INSPIRATION",
        "tiktok.title": "TIKTOK / REELS VIDEOS",
        "quick.title": "YOUR QUICK ACCESS",
        "quick.ebookCta": "Read now",
        "quick.toolsTitle": "TOOLS",
        "quick.toolsCta": "Sharing guides",
        "quick.qrTitle": "YOUR QR",
        "quick.qrCta": "Share",
        "quick.note": "Share your QR so your guests go directly to your start page.",
        "vault.title": "YOUR VAULT",
        "vault.webbookKicker": "READ",
        "vault.webbookTitle": "WEBBOOK",
        "vault.webbookSub": "Continue reading",
        "vault.pathKicker": "PATH",
        "vault.pathTitle": "THE TRUTH PATH",
        "vault.pathSub": "Your 40-day journey",
        "vault.toolsKicker": "GUIDES",
        "vault.toolsTitle": "TOOLS",
        "vault.toolsSub": "Shareable resources",
        "vault.open": "OPEN",
        "vault.note": "Everything here stays protected inside your dashboard.",
        "news.title": "NEWSLETTER & ANNOUNCEMENTS",
        "news.text": "Upcoming launches, community news and important reminders will appear 
here.",
      }
    };
        "footer.newBooks": "NEW BOOKS",
        "footer.news": "UPDATES",
        "footer.extra": "ANNOUNCEMENTS",
        "footer.logout": "LOG OUT",
        "qr.title": "Your invitation code",
        "qr.help": "Ask them to scan this QR or share your personal link."
    function getCurrentLang() {
      const stored = localStorage.getItem(LANG_KEY);
      if (stored === "en" || stored === "es") return stored;
      return "es";
    }
    function applyDashboardLanguage() {
      const lang = getCurrentLang();
      const dict = DASH_TRANSLATIONS[lang];
      document.querySelectorAll("[data-i18n]").forEach((el) => {
        const key = el.getAttribute("data-i18n");
        if (dict[key]) el.textContent = dict[key];
      });
      const phraseEl = document.getElementById("aiPhraseText");
      if (phraseEl) {
        phraseEl.textContent = (lang === "en")
          ? "“Your decision today opens doors you can't yet imagine.”"
          : "“Tu decisión de hoy abre puertas que aún no imaginas.”";
      }
      if (window.maUpdateReferralTexts) window.maUpdateReferralTexts();
      const codeLabel = (lang === "en") ? "CODE: " : "CÓDIGO: ";
      const footerRef = document.getElementById("footerRefId");
      const modalRefText = document.getElementById("qrModalRefText");
      let user = {};
      try { user = JSON.parse(localStorage.getItem("ma_user") || "{}"); } catch(e) {}
      const refid = user.refid || user.refId || "———";
      if (footerRef) footerRef.textContent = codeLabel + (refid || "———");
      if (modalRefText) modalRefText.textContent = codeLabel + (refid || "———");
    }
    window.maGetLang = getCurrentLang;
    window.maApplyDashboardLanguage = applyDashboardLanguage;
    document.addEventListener("DOMContentLoaded", function () {
      if (!document.body.classList.contains("ma-dashboard")) return;
      applyDashboardLanguage();
    });
  })();
  </script>
  <!-- Header compact -->
  <script>
  (function () {
    const header = document.getElementById("dashboardHeader");
    if (!header) return;
    function onScroll() {
      const y = window.scrollY || document.documentElement.scrollTop;
      header.classList.toggle("ma-header-compact", y > 24);
    }
    window.addEventListener("scroll", onScroll, { passive: true });
    onScroll();
  })();
  </script>
  <!-- QR pequeño + modal -->
  <script>
  (function () {
    const qrTile = document.querySelector(".ma-quick-card-qr");
    const qrCanvasSmall = document.getElementById("dashQrSmall");
    const modal = document.getElementById("qrModal");
    const modalBackdrop = document.getElementById("qrModalBackdrop");
    const modalClose = document.getElementById("qrModalClose");
    const modalCanvas = document.getElementById("qrModalCanvas");
    const modalRefText = document.getElementById("qrModalRefText");
    if (!qrTile || !qrCanvasSmall || !modal || !modalCanvas) return;
    let user = {};
    try { user = JSON.parse(localStorage.getItem("ma_user") || "{}"); } catch(e) {}
    const refid = user.refid || user.refId || "———";
    const baseUrl = window.location.origin + "/index.html";
    const personalLink = (refid && refid !== "———")
      ? baseUrl + "?ref=" + encodeURIComponent(refid)
      : baseUrl;
    try { new QRious({ element: qrCanvasSmall, value: personalLink, size: 68 }); } catch(e) {}
    try { new QRious({ element: modalCanvas, value: personalLink, size: 220 }); } catch(e) {}
    const lang = (window.maGetLang && window.maGetLang()) || "es";
    const codeLabel = (lang === "en") ? "CODE: " : "CÓDIGO: ";
    if (modalRefText) modalRefText.textContent = codeLabel + (refid || "———");
    const footerRef = document.getElementById("footerRefId");
    if (footerRef) footerRef.textContent = codeLabel + (refid || "———");
    function openModal() { modal.classList.add("is-visible"); }
    function closeModal() { modal.classList.remove("is-visible"); }
    qrTile.addEventListener("click", openModal);
    if (modalBackdrop) modalBackdrop.addEventListener("click", closeModal);
    if (modalClose) modalClose.addEventListener("click", closeModal);
  })();
  </script>
  <!-- Ajuste de textos de referidos -->
  <script>
  (function () {
    function updateReferralTexts() {
      const lang = (window.maGetLang && window.maGetLang()) || "es";
      const refEl = document.getElementById("dashReferralsText");
      const estEl = document.getElementById("dashEstimateText");
      if (refEl) {
        const parts = refEl.textContent.trim().split(" ");
        const num = parts[0] || "0";
        refEl.textContent = (lang === "en") ? (num + " REFERRALS") : (num + " REFERIDOS");
      }
      if (estEl) {
        const tokens = estEl.textContent.trim().split(" ");
        const amount = tokens[0] || "$0";
        const currency = tokens[1] || "USD";
        estEl.textContent = amount + " " + currency + " EST";
      }
    }
    document.addEventListener("DOMContentLoaded", function () {
      updateReferralTexts();
      setTimeout(updateReferralTexts, 800);
    });
    window.maUpdateReferralTexts = updateReferralTexts;
  })();
  </script>
  <!-- Tema: clásico / Black Edition -->
  <script>
  (function () {
    const THEME_KEY = "ma_theme";
    function applyTheme(theme, skipSave) {
      const body = document.body;
      const btn = document.getElementById("styleToggleBtn");
      const logo = document.querySelector(".ma-logo");
      if (theme === "dark") {
        body.classList.add("ma-theme-dark");
        if (btn) btn.textContent = "ESTILO: BLACK EDITION";
        if (logo) {
          logo.style.color = "#fdfaf0";
          logo.style.textShadow =
            "0 0 4px rgba(0,0,0,0.9)," +
            "0 10px 20px rgba(0,0,0,0.95)," +
            "0 0 16px rgba(212,175,55,0.9)," +
            "0 0 40px rgba(212,175,55,0.65)";
          logo.style.transform = "translateY(1px)";
        }
      } else {
        body.classList.remove("ma-theme-dark");
        if (btn) btn.textContent = "ESTILO: CLÁSICO";
        if (logo) { logo.style.color = ""; logo.style.textShadow = ""; logo.style.transform = 
""; }
    }
        theme = "classic";
      }
      if (!skipSave) {
        try { localStorage.setItem(THEME_KEY, theme); } catch(e) {}
      }
    document.addEventListener("DOMContentLoaded", function () {
      let saved = "classic";
      try {
        const stored = localStorage.getItem(THEME_KEY);
        if (stored === "dark" || stored === "classic") saved = stored;
      } catch(e) {}
      applyTheme(saved, true);
      const styleBtn = document.getElementById("styleToggleBtn");
      if (!styleBtn) return;
      styleBtn.addEventListener("click", function () {
        const isDark = document.body.classList.contains("ma-theme-dark");
        applyTheme(isDark ? "classic" : "dark", false);
      });
    });
  })();
  </script>
  <!-- Botón E-BOOK: abre última lectura o index por idioma -->
  <script>
  (function () {
    const btn = document.getElementById("ebookBtn");
    if (!btn) return;
    btn.addEventListener("click", function () {
      const lang = (window.maGetLang && window.maGetLang()) || "es";
      const baseIndex = (lang === "en") ? "/ebook.en/index.html" : "/ebook/index.html";
      try {
        const last = localStorage.getItem("wb_last_chapter") || "";
        if (last) { window.location.href = last; return; }
      } catch(e) {}
      window.location.href = baseIndex;
    });
  })();
  </script>
  <!-- VAULT links + TTP unlock -->
  <script>
  (function () {
    function isTruthy(v) {
      if (v === true) return true;
      if (typeof v === "string") return 
["1","true","yes","y","on"].includes(v.toLowerCase().trim());
      return false;
    }
    function getUnlockState() {
      const keys = [
        "ttp_unlocked",
        "ma_ttp_unlocked",
        "truth_path_unlocked",
        "tp_unlocked",
        "ttpUnlocked"
      ];
      for (const k of keys) {
        try {
          const v = localStorage.getItem(k);
          if (isTruthy(v)) return true;
        } catch(e) {}
      }
      // Si guardas en ma_user (opcional)
      try {
        const user = JSON.parse(localStorage.getItem("ma_user") || "{}");
        if (isTruthy(user.ttpUnlocked) || isTruthy(user.ttp_unlocked)) return true;
      } catch(e) {}
      return false;
    }
    function applyVaultLinks() {
      const lang = (window.maGetLang && window.maGetLang()) || "es";
      // WebBook banner: apunta al progreso o al index según idioma
      const wb = document.getElementById("vaultWebbookBtn");
      if (wb) {
        const baseIndex = (lang === "en") ? "/ebook.en/index.html" : "/ebook/index.html";
        let href = baseIndex;
        try {
          const last = localStorage.getItem("wb_last_chapter") || "";
          if (last) href = last;
        } catch(e) {}
        wb.setAttribute("href", href);
      }
      // TTP: solo visible si está desbloqueado
      const ttp = document.getElementById("vaultTtpBtn");
      if (ttp) {
        const unlocked = getUnlockState();
        if (unlocked) {
          ttp.style.display = "";
          const ttpHref = (lang === "en") ? "/media/ttpe/index.html" : "/media/ttps/index.html";
          ttp.setAttribute("href", ttpHref);
        } else {
          ttp.style.display = "none";
        }
      }
    }
    document.addEventListener("DOMContentLoaded", function () {
      applyVaultLinks();
      if (window.maApplyDashboardLanguage) window.maApplyDashboardLanguage();
    });
    // Si tu quiz desbloquea el TTP al vuelo, puedes llamar esto:
    window.maRefreshVault = applyVaultLinks;
  })();
  </script>
</body>
</html>

