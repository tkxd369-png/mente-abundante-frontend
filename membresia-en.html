 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Activate your access ‚Äî The Master Key</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />

  <style>
    body.ma-membership {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "DM Sans", sans-serif;
      background-color: #f6f0e8;
      color: #3a2f25;
      display: flex;
      flex-direction: column;
    }

    .ma-membership-shell {
      max-width: 960px;
      width: 100%;
      margin: 0 auto;
      padding: 2.2rem 1.4rem 2.8rem;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* HEADER (same style as index) */
    .ma-landing-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .ma-logo-block {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .ma-logo-tag {
      font-size: 0.7rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: #9b8570;
    }

    .ma-logo-title {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: 1.1rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #3a2f25;
    }

    .ma-login-link {
      font-size: 0.85rem;
      color: #7a6650;
      text-decoration: none;
      border-radius: 999px;
      border: 1px solid rgba(123, 102, 80, 0.25);
      padding: 0.35rem 0.9rem;
      background-color: #fdf8f1;
    }
    .ma-login-link:hover {
      background-color: #f5e4cf;
    }

    /* MAIN LAYOUT */
    .ma-membership-main {
      flex: 1;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 2.2rem;
      align-items: flex-start;
    }

    @media (max-width: 880px) {
      .ma-membership-main {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* LEFT SIDE: TEXT / DETAIL */
    .ma-membership-copy-eyebrow {
      font-size: 0.75rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: #9b8570;
      margin-bottom: 0.6rem;
    }

    .ma-membership-title {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: 1.8rem;
      line-height: 1.3;
      color: #3a2f25;
      margin-bottom: 0.6rem;
    }

    .ma-membership-subtitle {
      font-size: 0.98rem;
      color: #7a6650;
      margin-bottom: 1.4rem;
      max-width: 30rem;
    }

    .ma-membership-highlights {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 0.75rem;
      margin-bottom: 1.6rem;
    }

    .ma-membership-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.8rem;
      padding: 0.4rem 0.75rem;
      border-radius: 999px;
      background: #efe0cc;
      color: #5f4b36;
    }

    .ma-membership-detail-list {
      font-size: 0.88rem;
      color: #7a6650;
      padding-left: 1.1rem;
    }
    .ma-membership-detail-list li {
      margin-bottom: 0.4rem;
    }

    .ma-membership-ref-hint {
      font-size: 0.8rem;
      color: #97826b;
      margin-top: 0.8rem;
    }

    /* RIGHT SIDE: FORM */
    .ma-membership-form-card {
      background-color: #ffffff;
      border-radius: 24px;
      border: 1px solid rgba(0, 0, 0, 0.03);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.12);
      padding: 1.6rem 1.5rem 1.4rem;
    }

    .ma-form-title {
      font-size: 0.9rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #9b8570;
      margin-bottom: 0.4rem;
    }

    .ma-form-amount {
      font-size: 1.05rem;
      color: #3a2f25;
      margin-bottom: 1.1rem;
    }

    .ma-form-row {
      margin-bottom: 0.85rem;
    }

    .ma-form-label {
      display: block;
      font-size: 0.8rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #9b8570;
      margin-bottom: 0.25rem;
    }

    .ma-form-input {
      width: 100%;
      padding: 0.7rem 0.8rem;
      border-radius: 12px;
      border: 1px solid rgba(0, 0, 0, 0.12);
      background-color: #fbf5ec;
      font-size: 0.9rem;
      color: #3a2f25;
      outline: none;
    }

    .ma-form-input::placeholder {
      color: #b39b7f;
    }

    .ma-form-input:focus {
      border-color: #e3a95a;
      box-shadow: 0 0 0 1px rgba(227, 169, 90, 0.24);
      background-color: #fffdf8;
    }

    .ma-form-input[readonly] {
      background-color: #f3ebdf;
      cursor: default;
    }

    .ma-form-inline {
      display: flex;
      gap: 0.75rem;
    }

    @media (max-width: 600px) {
      .ma-form-inline {
        flex-direction: column;
      }
    }

    .ma-form-terms {
      margin-top: 0.8rem;
      margin-bottom: 0.4rem;
      font-size: 0.8rem;
      color: #7a6650;
      display: flex;
      align-items: flex-start;
      gap: 0.45rem;
    }

    .ma-form-terms input[type="checkbox"] {
      margin-top: 0.12rem;
    }

    .ma-form-error {
      min-height: 1.1rem;
      font-size: 0.8rem;
      color: #c04730;
      margin-bottom: 0.6rem;
    }

    .ma-form-note {
      font-size: 0.78rem;
      color: #97826b;
      margin-top: 0.4rem;
      line-height: 1.4;
    }

    .ma-form-cta {
      margin-top: 1rem;
    }

    .ma-form-button {
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 0.9rem 1.5rem;
      font-size: 0.95rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #f2c47b, #e3a95a);
      color: #2c241b;
      cursor: pointer;
      box-shadow: 0 16px 46px rgba(226, 167, 90, 0.5);
    }

    .ma-form-button:hover {
      filter: brightness(1.03);
    }

    /* FOOTER MINI */
    .ma-membership-footer {
      margin-top: 2.4rem;
      font-size: 0.8rem;
      color: #97826b;
      text-align: center;
    }

    .ma-membership-footer a {
      color: #7a6650;
      text-decoration: underline;
      text-underline-offset: 3px;
    }
  </style>
</head>

<body class="ma-membership">
  <div class="ma-membership-shell">
    <!-- HEADER -->
    <header class="ma-landing-header">
      <div class="ma-logo-block">
        <span class="ma-logo-tag">Private program</span>
        <span class="ma-logo-title">The Master Key</span>
      </div>
      <a href="login.html?lang=en" class="ma-login-link">Sign in</a>
    </header>

    <!-- MAIN -->
    <main class="ma-membership-main">
      <!-- LEFT SIDE: CONTEXT -->
      <section>
        <div class="ma-membership-copy-eyebrow">Step 2 ¬∑ Activate access</div>
        <h1 class="ma-membership-title">Your decision becomes access.</h1>

        <p class="ma-membership-subtitle">
          Here you confirm your details and activate your access to <strong>The Master Key</strong> and The Master Key community. This is a one-time contribution, your door in as a founding member.
        </p>

        <div class="ma-membership-highlights">
          <div class="ma-membership-chip">
            ‚ú® Access to the core content and main video
          </div>
          <div class="ma-membership-chip">
            ü§ù Private The Master Key community
          </div>
          <div class="ma-membership-chip">
            üîë Exclusive referral program for members
          </div>
        </div>

        <ul class="ma-membership-detail-list">
          <li>One-time payment to activate your access to the program.</li>
          <li>Your invitation code makes sure your sponsor receives credit.</li>
          <li>After confirming, you‚Äôll see the full video and the next steps.</li>
        </ul>

        <div id="refInfo" class="ma-membership-ref-hint"></div>
      </section>

      <!-- RIGHT SIDE: FORM -->
      <aside class="ma-membership-form-card">
        <div class="ma-form-title">Confirm activation</div>
        <div class="ma-form-amount">One-time contribution: <strong>USD $777</strong></div>

        <div class="ma-form-row ma-form-inline">
          <div style="flex:1;">
            <label class="ma-form-label" for="fullName">Full name</label>
            <input
              id="fullName"
              class="ma-form-input"
              type="text"
              placeholder="As it appears in your documents"
              autocomplete="name"
            />
          </div>
        </div>

        <div class="ma-form-row ma-form-inline">
          <div style="flex:1;">
            <label class="ma-form-label" for="email">Email</label>
            <input
              id="email"
              class="ma-form-input"
              type="email"
              placeholder="you@example.com"
              autocomplete="email"
            />
          </div>
          <div style="flex:1;">
            <label class="ma-form-label" for="phone">Phone</label>
            <input
              id="phone"
              class="ma-form-input"
              type="tel"
              placeholder="+1 ..."
              autocomplete="tel"
            />
          </div>
        </div>

        <div class="ma-form-row">
          <label class="ma-form-label" for="country">Country</label>
          <select id="country" class="ma-form-input">
            <!-- Options filled by JavaScript -->
          </select>
        </div>

        <div class="ma-form-row">
          <label class="ma-form-label" for="refCode">Invitation code</label>
          <input
            id="refCode"
            class="ma-form-input"
            type="text"
            placeholder="Auto-filled if you come with a personal link"
            readonly
          />
        </div>

        <div class="ma-form-terms">
          <input type="checkbox" id="termsCheck" />
          <label for="termsCheck">
            I confirm this contribution is final and I have read and accept the
            <a href="terms-en.html" target="_blank">Terms &amp; Conditions</a>
            and the no-refund policy.
          </label>
        </div>

        <div id="formError" class="ma-form-error"></div>

        <div class="ma-form-cta">
          <button id="btnContinuarPago" type="button" class="ma-form-button">
            Continue to payment
          </button>
        </div>

        <div class="ma-form-note">
          On the next screen you‚Äôll see the details of your contribution and access to the main video. Your invitation code will be linked to your account.
        </div>
      </aside>
    </main>

    <!-- FOOTER -->
    <footer class="ma-membership-footer">
      Questions? You can go back to the main page or sign in if you are already a member.
      <br />
      <a href="index-en.html">Back to The Master Key</a> ¬∑
      <a href="login.html?lang=en">Sign in to your account</a> ¬∑
      <a href="terms-en.html" target="_blank">Terms &amp; Conditions</a>
    </footer>
  </div>

  <script>
    (function () {
      // Mark language as EN for the rest of the flow
      try {
        localStorage.setItem("ma_lang", "en");
      } catch (e) {}

      const MA_PAYOUT_COUNTRIES = [
        { code: "US", name: "United States" },
        { code: "CA", name: "Canada" },
        { code: "MX", name: "Mexico" },
        { code: "AR", name: "Argentina" },
        { code: "BO", name: "Bolivia" },
        { code: "BR", name: "Brazil" },
        { code: "CL", name: "Chile" },
        { code: "CO", name: "Colombia" },
        { code: "CR", name: "Costa Rica" },
        { code: "DO", name: "Dominican Republic" },
        { code: "EC", name: "Ecuador" },
        { code: "PA", name: "Panama" },
        { code: "PE", name: "Peru" },
        { code: "PY", name: "Paraguay" },
        { code: "SV", name: "El Salvador" },
        { code: "UY", name: "Uruguay" }
      ];

      const params = new URLSearchParams(window.location.search);
      const refFromUrl = params.get("ref") || "";
      let refCode = refFromUrl;

      // Recover ref from localStorage if not in URL
      try {
        const storedRef = localStorage.getItem("ma_ref_code");
        if (!refCode && storedRef) {
          refCode = storedRef;
        }
      } catch (e) {
        // ignore
      }

      // Save ref in localStorage for the rest of the flow
      try {
        if (refCode) {
          localStorage.setItem("ma_ref_code", refCode);
        }
      } catch (e) {
        // ignore
      }

      // Prefill code in field
      const refInput = document.getElementById("refCode");
      const refInfo = document.getElementById("refInfo");
      if (refInput) {
        refInput.value = refCode || "";
      }
      if (refInfo) {
        if (refCode) {
          refInfo.textContent =
            "You are activating your access with the invitation code: " + refCode + ".";
        } else {
          refInfo.textContent =
            "If someone invited you, make sure you use their personal link so their code is registered correctly.";
        }
      }

      function populateCountrySelect(selectEl, preSelected) {
        if (!selectEl) return;

        selectEl.innerHTML = "";

        const placeholder = document.createElement("option");
        placeholder.value = "";
        placeholder.textContent = "Select your country";
        selectEl.appendChild(placeholder);

        MA_PAYOUT_COUNTRIES.forEach((c) => {
          const opt = document.createElement("option");
          opt.value = c.code;
          opt.textContent = c.name;
          selectEl.appendChild(opt);
        });

        if (preSelected) {
          selectEl.value = preSelected;
        }
      }

      // Prefill stored data
      const fullNameInput = document.getElementById("fullName");
      const emailInput = document.getElementById("email");
      const phoneInput = document.getElementById("phone");
      const countryInput = document.getElementById("country");
      const termsCheck = document.getElementById("termsCheck");
      const formError = document.getElementById("formError");
      const btnContinuar = document.getElementById("btnContinuarPago");

      try {
        const preName = localStorage.getItem("ma_pre_fullName");
        const preEmail = localStorage.getItem("ma_pre_email");
        const prePhone = localStorage.getItem("ma_pre_phone");
        const preCountry = localStorage.getItem("ma_pre_country");

        if (preName && fullNameInput) fullNameInput.value = preName;
        if (preEmail && emailInput) emailInput.value = preEmail;
        if (prePhone && phoneInput) phoneInput.value = prePhone;

        // fill dropdown
        populateCountrySelect(countryInput, preCountry || "");
      } catch (e) {
        // ignore
      }

      function showError(msg) {
        if (formError) formError.textContent = msg || "";
      }

      if (btnContinuar) {
        btnContinuar.addEventListener("click", function () {
          const fullName = (fullNameInput?.value || "").trim();
          const email = (emailInput?.value || "").trim();
          const phone = (phoneInput?.value || "").trim();
          const country = (countryInput?.value || "").trim();
          const termsAccepted = !!(termsCheck && termsCheck.checked);

          if (!fullName || !email || !phone) {
            showError("Please complete at least full name, email and phone.");
            return;
          }
          if (!termsAccepted) {
            showError("You must confirm the terms before continuing.");
            return;
          }

          showError("");

          // Save data for next screens
          try {
            localStorage.setItem("ma_pre_fullName", fullName);
            localStorage.setItem("ma_pre_email", email);
            localStorage.setItem("ma_pre_phone", phone);
            localStorage.setItem("ma_pre_country", country || "");
            if (refCode) {
              localStorage.setItem("ma_ref_code", refCode);
            }
          } catch (e) {
            // ignore
          }

          // Simulated flow: go to English bridge page
          window.location.href = "puente-video-en.html";
        });
      }
    })();
  </script>
</body>
</html>
